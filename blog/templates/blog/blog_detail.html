{% extends "base.html" %}

{% block title %}{{ post.title }} â€“ Avenue One Agency{% endblock %}
{% block description %}{{ post.meta_description|default:post.content|truncatewords:25 }}{% endblock %}

{% block meta %}
  <meta name="author" content="{{ post.author.get_full_name|default:post.author.username }}">
  <meta property="og:title" content="{{ post.title }}">
  <meta property="og:description" content="{{ post.meta_description|default:post.content|truncatewords:25 }}">
  <meta property="og:type" content="article">
  <meta property="og:url" content="{{ request.build_absolute_uri }}">
  {% if post.featured_image %}
    <meta property="og:image" content="{{ post.featured_image.url }}">
  {% endif %}

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ post.title }}">
  <meta name="twitter:description" content="{{ post.meta_description|default:post.content|truncatewords:25 }}">
  {% if post.featured_image %}
    <meta name="twitter:image" content="{{ post.featured_image.url }}">
  {% endif %}
{% endblock %}

{% block content %}
<section class="py-5">
  <div class="container">
    <div class="row">

      <div class="col-md-9">
        <!-- ðŸ§­ Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'blog' %}">Blog</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ post.title }}</li>
          </ol>
        </nav>

        <!-- ðŸ“„ Blog Content -->
        <article>
          <h1>{{ post.title }}</h1>
          <p class="text-muted">
            Published on {{ post.created_at|date:"d. F Y" }}
            {% if post.author %}
            by {{ post.author.get_full_name|default:post.author.username }}
            {% endif %}
          </p>

          {% if post.featured_image %}
            <picture>
              <source srcset="{{ post.webp_image_url }}" type="image/webp">
              <img src="{{ post.featured_image.url }}"
                   width="{{ post.image_width }}"
                   height="{{ post.image_height }}"
                   alt="{{ post.title }}"
                   class="img-fluid mb-4"
                   loading="lazy">
            </picture>
          {% endif %}

          <div class="content">
            {{ post.content|safe }}
          </div>

          <!-- ðŸ·ï¸ Tags -->
          {% if post.tags.all %}
            <div class="mt-4">
              <h5>Tags:</h5>
              <ul class="list-inline">
                {% for tag in post.tags.all %}
                  <li class="list-inline-item">
                    <a href="{% url 'blog_by_tag' tag.slug %}" class="badge bg-secondary text-decoration-none">{{ tag.name }}</a>
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}
        </article>

        <!-- ðŸ“š Related Posts -->
        {% if related_posts %}
          <hr class="my-5">
          <h3>Related posts</h3>
          <div class="row">
            {% for related in related_posts %}
              <div class="col-md-6 mb-4">
                <div class="card h-100 shadow-sm">
                  <div class="card-body">
                    {% if related.featured_image %}
                      <img src="{{ related.featured_image.url }}" alt="{{ related.title }}" class="img-fluid mb-3" loading="lazy">
                    {% endif %}
                    <h5><a href="{% url 'blog_detail' slug=related.slug %}">{{ related.title }}</a></h5>
                    <a href="{% url 'blog_detail' slug=related.slug %}" class="btn btn-outline-primary btn-sm">Read more</a>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}


